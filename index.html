<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">SENSUALE PAIX√ÉO</title>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        :root { --bg: #503838; --accent: #d4af37; --card: #2d0202; --white: #fff; }
        body { background: var(--bg); color: var(--white); font-family: 'Inter', sans-serif; margin: 0; overflow-x: hidden; }
        
        header { padding: 15px 20px; border-bottom: 1px solid var(--accent); display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; background: var(--bg); z-index: 1000; }
        .brand { display: flex; align-items: center; gap: 12px; }
        .logo-top { height: 45px; object-fit: contain; }
        .store-name { font-size: 1.1rem; font-weight: 800; color: var(--accent); text-transform: uppercase; }

        /* --- CARROSSEL INFINITO SEM EMENDAS --- */
        .slider-container { width: 100%; overflow: hidden; background: #2d0202; padding: 20px 0; }
        .slider-track { 
            display: flex; 
            gap: 15px; 
            width: max-content; 
            animation: scroll-infinito 30s linear infinite; 
            will-change: transform;
        }
        
        .slider-track:hover { animation-play-state: paused; }

        @keyframes scroll-infinito {
            0% { transform: translateX(0); }
            /* Move exatamente 1/3 do trilho (o tamanho do conjunto original) */
            100% { transform: translateX(calc(-33.333% - 10px)); } 
        }

        .slide { min-width: 300px; height: 220px; border-radius: 12px; border: 2px solid var(--accent); flex-shrink: 0; cursor: pointer; overflow: hidden; }
        @media (max-width: 768px) { .slide { min-width: 280px; } }
        .slide img { width: 100%; height: 100%; object-fit: cover; }
        /* ---------------------------------------- */

        .categories-grid { display: flex; gap: 20px; padding: 25px; justify-content: center; flex-wrap: wrap; }
        .cat-item { text-align: center; cursor: pointer; min-width: 85px; }
        .cat-circle { width: 75px; height: 75px; border-radius: 50%; border: 2.5px solid var(--accent); overflow: hidden; margin: 0 auto 8px; background: #000; }
        .cat-circle img { width: 100%; height: 100%; object-fit: cover; }
        .cat-item span { font-size: 0.7rem; font-weight: bold; text-transform: uppercase; color: var(--accent); }

        .container { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 15px; padding: 20px; max-width: 1200px; margin: auto; }
        .card { background: var(--card); border: 1px solid var(--accent); border-radius: 12px; overflow: hidden; text-align: center; display: flex; flex-direction: column; }
        .card img { width: 100%; aspect-ratio: 1/1; object-fit: cover; }
        
        .card-body { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .card h4 { margin: 0 0 5px 0; font-size: 1rem; color: var(--white); }
        .desc-prod { font-size: 0.8rem; color: #fdfdfd; opacity: 0.8; margin-bottom: 10px; line-height: 1.2; height: 2.4em; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
        .preco-tag { color: var(--accent); font-weight: 900; font-size: 1.2rem; margin-bottom: 15px; }

        .btn-add { display: block; width: 100%; padding: 15px; background: var(--accent); color: var(--bg); font-weight: bold; cursor: pointer; border: none; text-transform: uppercase; }

        footer { background: #2d0202; border-top: 2px solid var(--accent); padding: 50px 20px; text-align: center; margin-top: 50px; }
        .footer-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; max-width: 1200px; margin: 0 auto 40px; text-align: left; }
        .footer-box h3 { color: var(--accent); font-size: 1rem; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; }
        .footer-box p, .footer-box a { color: #fdfdfd; font-size: 0.85rem; text-decoration: none; display: block; margin-bottom: 12px; opacity: 0.8; line-height: 1.5; }
        .footer-box a:hover { opacity: 1; color: var(--accent); }
        .footer-bottom { border-top: 1px solid rgba(212, 175, 55, 0.2); padding-top: 25px; font-size: 0.75rem; opacity: 0.6; }

        #cart-icon { position: fixed; bottom: 25px; right: 25px; background: var(--accent); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 1001; cursor: pointer; box-shadow: 0 5px 15px #000; }
        #cart-count { position: absolute; top: -5px; right: -5px; background: white; color: black; width: 22px; height: 22px; border-radius: 50%; font-size: 0.7rem; font-weight: bold; display: flex; align-items: center; justify-content: center; }

        #cart-sidebar { position: fixed; top: 0; right: -100%; width: 330px; height: 100%; background: var(--bg); border-left: 2px solid var(--accent); z-index: 2000; transition: 0.4s; padding: 25px; box-sizing: border-box; display: flex; flex-direction: column; }
        #cart-sidebar.active { right: 0; }
        .item-cart { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #2d0202; }
    </style>
</head>
<body>

    <header>
        <div class="brand"><img src="" id="logoLoja" class="logo-top"><span id="nomeLojaHeader" class="store-name"></span></div>
        <input type="text" id="busca" placeholder="Buscar..." onkeyup="filtrar()" style="background:#2d0202; border:1px solid var(--accent); color:white; padding:8px 15px; border-radius:20px; width:120px; outline:none;">
    </header>

    <div class="slider-container"><div class="slider-track" id="sliderTrack"></div></div>
    <div class="categories-grid" id="listaCategorias"></div>
    <div class="container" id="vitrine"></div>

    <footer>
        <div class="footer-grid">
            <div class="footer-box">
                <h3>Sobre a Loja</h3>
                <p>Prazer, autocuidado & sensualidade üíã</p>
                <div id="txtEndereco" style="color:var(--accent); font-weight:bold;"></div>
            </div>
            <div class="footer-box">
                <h3>Contatos</h3>
                <a href="#" id="btnWpp">WhatsApp Comercial</a>
                <a href="#" id="btnInsta">Siga-nos no Instagram</a>
                <p>Hor√°rio: Seg. a S√°b. - 10h √†s 18h</p>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2026 <span id="nomeLojaFooter"></span>. Todos os direitos reservados.
        </div>
    </footer>

    <div id="cart-icon" onclick="toggleCart(true)">
        <svg width="26" height="26" fill="#4a0404" viewBox="0 0 24 24"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1z"/></svg>
        <div id="cart-count">0</div>
    </div>

    <div id="cart-sidebar">
        <h2 style="color:var(--accent);">Meu Pedido</h2>
        <div id="lista-carrinho" style="flex-grow:1; overflow-y:auto; color: white;"></div>
        <div id="total-carrinho" style="font-weight:bold; margin:20px 0; font-size:1.2rem; color:var(--accent);">Total: R$ 0,00</div>
        <button onclick="enviarPedido()" style="background:#25d366; color:white; border:none; padding:18px; width:100%; font-weight:bold; border-radius:10px; cursor:pointer;">FINALIZAR NO WHATSAPP</button>
        <button onclick="toggleCart(false)" style="background:transparent; color:#999; border:none; margin-top:15px; cursor:pointer;">FECHAR</button>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://omnicommerce-njs-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let wppAtivo = ""; let baseProdutos = []; let carrinho = []; let fotoPadraoBolha = "";

        db.ref('loja_njs_salvador/config').on('value', snap => {
            const c = snap.val();
            if(c) {
                document.getElementById('logoLoja').src = c.logo_url || "";
                document.getElementById('nomeLojaHeader').innerText = c.nome_loja || "";
                const nomeFooter = document.getElementById('nomeLojaFooter');
                if(nomeFooter) nomeFooter.innerText = c.nome_loja || "";

                document.getElementById('txtEndereco').innerText = "üìç " + (c.endereco || "");
                wppAtivo = c.whatsapp;
                fotoPadraoBolha = c.foto_padrao_cat || "";
                document.getElementById('btnInsta').href = "https://instagram.com/" + (c.instagram || "");
                document.getElementById('btnWpp').href = "https://wa.me/" + wppAtivo;
                
                const track = document.getElementById('sliderTrack');
                let slidesHTML = "";
                for(let i=0; i<6; i++) {
                    const img = c[`c_img_${i}`];
                    const lnk = c[`c_lnk_${i}`];
                    if(img) slidesHTML += `<div class="slide" onclick="direcionar('${lnk}')"><img src="${img}"></div>`;
                }
                // TRIPULAMOS PARA GARANTIR QUE SEMPRE TENHA IMAGEM NA TELA E A EMENDA FIQUE INVIS√çVEL
                track.innerHTML = slidesHTML + slidesHTML + slidesHTML;
            }
        });

        function direcionar(termo) {
            if(!termo) return;
            const busca = termo.toUpperCase();
            const filtrados = baseProdutos.filter(p => p.secao.toUpperCase() === busca || p.nome.toUpperCase().includes(busca));
            if(filtrados.length > 0) renderizar(filtrados);
            window.scrollTo({ top: document.getElementById('vitrine').offsetTop - 100, behavior: 'smooth' });
        }

        function minerar(obj, lista) {
            if(!obj) return;
            if(obj.nome && obj.valor_venda) lista.push(obj);
            else Object.values(obj).forEach(v => typeof v === 'object' && minerar(v, lista));
        }

        db.ref('loja_njs_salvador/produtos').on('value', snap => {
            baseProdutos = []; minerar(snap.val(), baseProdutos);
            renderizar(baseProdutos);
            const grid = document.getElementById('listaCategorias');
            const cats = [...new Set(baseProdutos.map(p => p.secao).filter(Boolean))];
            grid.innerHTML = `<div class="cat-item" onclick="renderizar(baseProdutos)"><div class="cat-circle"><img src="${fotoPadraoBolha || 'https://via.placeholder.com/100?text=TUDO'}"></div><span>TUDO</span></div>`;
            cats.forEach(c => {
                const foto = fotoPadraoBolha || baseProdutos.find(p => p.secao === c).url_imagem;
                grid.innerHTML += `<div class="cat-item" onclick="renderizar(baseProdutos.filter(p=>p.secao=='${c}'))"><div class="cat-circle"><img src="${foto}"></div><span>${c}</span></div>`;
            });
        });

        function renderizar(lista) {
            const v = document.getElementById('vitrine');
            v.innerHTML = "";
            lista.forEach(p => {
                v.innerHTML += `
                    <div class="card">
                        <img src="${p.url_imagem}">
                        <div class="card-body">
                            <div>
                                <h4>${p.nome}</h4>
                                <div class="desc-prod">${p.descricao || 'Sensualidade e eleg√¢ncia para momentos especiais.'}</div>
                            </div>
                            <div class="preco-tag">R$ ${parseFloat(p.valor_venda).toFixed(2)}</div>
                            <button class="btn-add" onclick="addCarrinho('${p.nome}', ${p.valor_venda})">+ CARRINHO</button>
                        </div>
                    </div>`;
            });
        }

        function addCarrinho(nome, preco) {
            carrinho.push({nome, preco});
            atualizarUI();
            toggleCart(true);
        }

        function toggleCart(open) { document.getElementById('cart-sidebar').classList.toggle('active', open); }

        function atualizarUI() {
            document.getElementById('cart-count').innerText = carrinho.length;
            const l = document.getElementById('lista-carrinho');
            l.innerHTML = ""; let total = 0;
            carrinho.forEach((item, i) => {
                total += item.preco;
                l.innerHTML += `<div class="item-cart"><span>${item.nome}</span><span>R$ ${item.preco.toFixed(2)} <b onclick="remover(${i})" style="color:red; cursor:pointer;">√ó</b></span></div>`;
            });
            document.getElementById('total-carrinho').innerText = `Total: R$ ${total.toFixed(2)}`;
        }

        function remover(i) { carrinho.splice(i, 1); atualizarUI(); }

        function enviarPedido() {
            if(carrinho.length === 0) return;
            let msg = "*PEDIDO - SENSUALE PAIX√ÉO*%0A%0A";
            carrinho.forEach(item => { msg += `‚Ä¢ ${item.nome}%0A`; });
            window.open(`https://wa.me/${wppAtivo}?text=${msg}`, '_blank');
        }

        function filtrar() {
            const t = document.getElementById('busca').value.toLowerCase();
            renderizar(baseProdutos.filter(p => p.nome.toLowerCase().includes(t)));
        }
    </script>
</body>
</html>